太好了，我們來設計一套《灰燼家族》的**傳承演算法**，目的是讓：

* 每代族人從上一代繼承特質、突變或靈能

* 結合「機率模擬」與「敘事風格」產生角色變異

* 支援家族策略，如：繁衍、收養、交換源血

---

## **🔧 一、基礎架構**

### **🎯 目標**

生成下一代族人時，根據以下來源進行「基因模擬」：

| 來源 | 說明 |
| ----- | ----- |
| 雙親的顯性／隱性基因 | 繼承主要特質的主因 |
| 家族特質影響 | 某些屬性會在整個家族中穩定延續 |
| 遺傳記憶／AI 錄音筆 | 可額外影響技能／選項開啟 |
| 出生環境 | 地區輻射濃度、風水、血地等條件 |
| 事件觸發 | 某些基因需要特定儀式或衝突觸發 |

---

## **🧬 二、演算法流程**

### **1\. 建立基因池**

每個族人有一組基因資料結構：

{  
  "顯性": \["夜視眼", "憤怒血統"\],  
  "隱性": \["肺氣虛寒", "心火偏盛"\],  
  "稀有因子": \["陰蹻脈覺醒"\],  // 機率極低 or 事件觸發  
  "源血碼": "ABC-123-XYZ"  
}

---

### **2\. 配對時生成新基因池**

模擬以下步驟：

| 步驟 | 說明 |
| ----- | ----- |
| → 雙親顯性 50\~70% 機率繼承 |  |
| → 雙親隱性 15\~30% 機率突顯 |  |
| → 突變因子（環境+家族詛咒+血統不純）有 5\~10% 機率誕生新屬性 |  |
| → 特殊事件（如中邪、附體）可以強制解鎖靈能或稀有經脈 |  |

---

### **3\. 家族特質修正因子**

例如：

* 「靈根穩定」家族：靈能相關遺傳機率 \+20%

* 「陰火不熄」家族：憂鬱、怨念基因更容易浮現

* 「山神眷顧」家族：七魄覺醒與陰蹻脈相關屬性會代代遺傳

---

### **4\. 加入故事敘事機制（可選）**

當某個基因成功遺傳，有機率產生以下敘事片段：

你在孩子出生的當天夢見了死去的母親，她低語：「那團火，還沒熄。」  
你知道，這孩子繼承了「心火偏盛」的血。

或者：

孩子生於雷雨夜，哭聲竟與山中遠鼓相應。族老說，他與「陰蹻脈」有緣。

---

## **🔄 三、範例演算流程（簡化版）**

假設父母為：

* 👩 父：夜視眼（顯性）、預知潛能（隱性）

* 👨 母：抗輻射體質（顯性）、心火偏盛（隱性）

出生地：中輻射山地＋風水陰地

演算流程：

1. 隨機擲骰 → 夜視眼傳承 ✅

2. 預知潛能未激活 ❌（需事件觸發）

3. 抗輻射體質未傳承 ❌

4. 心火偏盛顯性突顯 ✅

5. 因地點風水→ 加入「七魄躁動：屍狗」突變 🐺

→ 最終結果：

{  
  "基因": \["夜視眼", "心火偏盛", "七魄躁動：屍狗"\],  
  "體質": "躁動靈根",  
  "壽命": 38,  
  "特性描述": "眼神銳利，心火難息，對死靈氣場有強烈反應"  
}

---

## **📌 四、擴充可能**

* 源血融合：將外族源血導入新族人中，擁有不尋常混合體質。

* 靈根淨化：透過儀式或事件去除不想要的突變（但可能留下代價）。

* 基因地圖 UI：玩家可檢視家族歷代傳承脈絡（像技能樹混血樹）。

---

| 階段 | 來源/條件 | 機率／規則 |
| :---- | :---- | :---- |
| 1\. 建立基因池 | 父母的顯性、隱性、稀有基因 \+ 源血碼 | 各類型基因以 50-100% 權重進入候選池 |
| 2\. 判定顯性遺傳 | 雙親顯性基因 | 每項有 50\~70% 機率繼承 |
| 3\. 判定隱性浮現 | 雙親隱性基因 | 雙親皆有 → 30%；單親有 → 15% |
| 4\. 稀有基因激活 | 特殊血脈／祖先／源血碼 | 需事件觸發或環境相合 |
| 5\. 環境突變因子 | 出生地輻射／風水／鬼氣 | 影響突變與靈能因子出現機率（+5\~20%） |
| 6\. 家族特質修正 | 家族體質標籤／血統設定 | 如『靈根穩定』提高靈能基因機率 \+20% |
| 7\. 敘事片段生成 | 傳承成功時有機率產生 | 觸發特殊敘事（夢境／祖靈對話／異象） |

{  
  "gene\_inheritance\_algorithm": \[  
    {  
      "stage": "1. 建立基因池",  
      "source": "父母的顯性、隱性、稀有基因 \+ 源血碼",  
      "rule": "各類型基因以 50-100% 權重進入候選池"  
    },  
    {  
      "stage": "2. 判定顯性遺傳",  
      "source": "雙親顯性基因",  
      "rule": "每項有 50\~70% 機率繼承"  
    },  
    {  
      "stage": "3. 判定隱性浮現",  
      "source": "雙親隱性基因",  
      "rule": "雙親皆有 → 30%；單親有 → 15%"  
    },  
    {  
      "stage": "4. 稀有基因激活",  
      "source": "特殊血脈／祖先／源血碼",  
      "rule": "需事件觸發或環境相合"  
    },  
    {  
      "stage": "5. 環境突變因子",  
      "source": "出生地輻射／風水／鬼氣",  
      "rule": "影響突變與靈能因子出現機率（+5\~20%）"  
    },  
    {  
      "stage": "6. 家族特質修正",  
      "source": "家族體質標籤／血統設定",  
      "rule": "如『靈根穩定』提高靈能基因機率 \+20%"  
    },  
    {  
      "stage": "7. 敘事片段生成",  
      "source": "傳承成功時有機率產生",  
      "rule": "觸發特殊敘事（夢境／祖靈對話／異象）"  
    }  
  \]  
}

